@using PigFarmManagement.Shared.Models

<MudGrid>
    <!-- Total Active Pig Pens -->
    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4">
            <MudCardContent>
                <div class="d-flex align-center">
                    <MudIcon Icon="Icons.Material.Filled.Home" Color="Color.Primary" Size="Size.Large" Class="mr-3" />
                    <div>
                        <MudText Typo="Typo.h4" Color="Color.Primary">@Overview.TotalActivePigPens</MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary">Total Active Pig Pens</MudText>
                    </div>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Cash Pig Pens -->
    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4">
            <MudCardContent>
                <div class="d-flex align-center">
                    <MudIcon Icon="Icons.Material.Filled.AttachMoney" Color="Color.Success" Size="Size.Large" Class="mr-3" />
                    <div>
                        <MudText Typo="Typo.h4" Color="Color.Success">@Overview.TotalPigsCash</MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary">Cash Pigs</MudText>
                    </div>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Project Pig Pens -->
    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4">
            <MudCardContent>
                <div class="d-flex align-center">
                    <MudIcon Icon="Icons.Material.Filled.BusinessCenter" Color="Color.Info" Size="Size.Large" Class="mr-3" />
                    <div>
                        <MudText Typo="Typo.h4" Color="Color.Info">@Overview.TotalPigsProject</MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary">Project Pigs</MudText>
                    </div>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Total Investment -->
    <MudItem xs="12" sm="6" md="3">
        <MudCard Elevation="3" Class="pa-4">
            <MudCardContent>
                <div class="d-flex align-center">
                    <MudIcon Icon="Icons.Material.Filled.TrendingUp" Color="Color.Warning" Size="Size.Large" Class="mr-3" />
                    <div>
                        <MudText Typo="Typo.h4" Color="Color.Warning">@FormatCurrency(TotalInvestment)</MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary">Total Investment</MudText>
                    </div>
                </div>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>

<!-- Financial Summary by Type -->
<MudGrid Class="mt-4">
    <MudItem xs="12" md="6">
        <MudCard Elevation="3">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">
                        <MudIcon Icon="Icons.Material.Filled.AttachMoney" Class="mr-2" />
                        Cash Business Summary
                    </MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudList>
                    <MudListItem>
                        <MudText><strong>Investment:</strong> @FormatCurrency(Overview.TotalInvestmentCash)</MudText>
                    </MudListItem>
                    <MudListItem>
                        <MudText><strong>Profit/Loss:</strong> 
                            <span style="color: @(Overview.TotalProfitLossCash >= 0 ? "green" : "red")">
                                @FormatCurrency(Overview.TotalProfitLossCash)
                            </span>
                        </MudText>
                    </MudListItem>
                    <MudListItem>
                        <MudText><strong>ROI:</strong> @FormatPercentage(CalculateROI(Overview.TotalProfitLossCash, Overview.TotalInvestmentCash))</MudText>
                    </MudListItem>
                </MudList>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="6">
        <MudCard Elevation="3">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">
                        <MudIcon Icon="Icons.Material.Filled.BusinessCenter" Class="mr-2" />
                        Project Business Summary
                    </MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudList>
                    <MudListItem>
                        <MudText><strong>Investment:</strong> @FormatCurrency(Overview.TotalInvestmentProject)</MudText>
                    </MudListItem>
                    <MudListItem>
                        <MudText><strong>Profit/Loss:</strong> 
                            <span style="color: @(Overview.TotalProfitLossProject >= 0 ? "green" : "red")">
                                @FormatCurrency(Overview.TotalProfitLossProject)
                            </span>
                        </MudText>
                    </MudListItem>
                    <MudListItem>
                        <MudText><strong>ROI:</strong> @FormatPercentage(CalculateROI(Overview.TotalProfitLossProject, Overview.TotalInvestmentProject))</MudText>
                    </MudListItem>
                </MudList>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>

@code {
    [Parameter] public DashboardOverview Overview { get; set; } = null!;

    private decimal TotalInvestment => Overview.TotalInvestmentCash + Overview.TotalInvestmentProject;

    private string FormatCurrency(decimal amount)
    {
        return $"${amount:N2}";
    }

    private string FormatPercentage(decimal percentage)
    {
        return $"{percentage:P1}";
    }

    private decimal CalculateROI(decimal profit, decimal investment)
    {
        return investment != 0 ? profit / investment : 0;
    }
}
