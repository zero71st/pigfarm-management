@using PigFarmManagement.Shared.Models
@using System.Globalization

<MudCard Elevation="3" Class="mt-4">
    <MudCardHeader class="ml-4">
        <CardHeaderContent>
            <MudText Typo="Typo.h6">
                <MudIcon Icon="@Icons.Material.Filled.Money" Class="mr-2" Color="Color.Success" />
                สรุปผลการดำเนินงานของลูกค้า (เงินสด)
            </MudText>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent class="ml-4">
        <MudTable Items="@CustomerStatsCash" Hover="true" Striped="true" Dense="true" RowsPerPage="10">
            <HeaderContent>
                <MudTh>ชื่อลูกค้า</MudTh>
                <MudTh>จำนวนคอก</MudTh>
                <MudTh>จำนวนสุกร</MudTh>
                <MudTh>รายได้จากลูกค้า</MudTh>
                <MudTh>กำไร/ขาดทุน</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="ชื่อลูกค้า">@context.CustomerName</MudTd>
                <MudTd DataLabel="จำนวนคอก">@context.PigPenCount</MudTd>
                <MudTd DataLabel="จำนวนสุกร">@context.TotalPigs</MudTd>
                <MudTd DataLabel="รายได้จากลูกค้า">@FormatCurrency(context.TotalPriceIncludeDiscount)</MudTd>
                <MudTd DataLabel="กำไร/ขาดทุน">
                    <span style="color: @(context.TotalProfitLoss >= 0 ? "green" : "red")">
                        @FormatCurrency(context.TotalProfitLoss)
                    </span>
                </MudTd>
            </RowTemplate>
            <PagerContent>
                @if (CustomerStatsCash?.Count > 10)
                {
                    <MudTablePager />
                }
            </PagerContent>
        </MudTable>
    </MudCardContent>
</MudCard>

@code {
    [Parameter] public List<CustomerPigPenStats> CustomerStatsCash { get; set; } = new();

    private string FormatCurrency(decimal amount)
    {
        return amount.ToString("N2", new CultureInfo("th-TH"));
    }
}
