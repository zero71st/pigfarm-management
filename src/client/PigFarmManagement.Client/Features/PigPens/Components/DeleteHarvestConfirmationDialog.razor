@using Microsoft.AspNetCore.Components
@using MudBlazor
@using PigFarmManagement.Shared.Models

<MudDialog>
    <DialogContent>
        <MudContainer Style="max-width: 500px;">
            <MudGrid>
                <MudItem xs="12">
                    <div class="d-flex align-center mb-4">
                        <MudIcon Icon="Icons.Material.Filled.Warning" 
                                 Color="Color.Warning" 
                                 Size="Size.Large" 
                                 Class="mr-3" />
                        <MudText Typo="Typo.h6">
                            Confirm Delete Harvest
                        </MudText>
                    </div>
                </MudItem>
                
                <MudItem xs="12">
                    <MudAlert Severity="Severity.Warning">
                        <MudText>Are you sure you want to delete this harvest record? This action cannot be undone.</MudText>
                    </MudAlert>
                </MudItem>
                
                <MudItem xs="12">
                    <MudPaper Class="pa-4" Elevation="1">
                        <MudText Typo="Typo.subtitle1" Class="mb-2">
                            <strong>Harvest Details:</strong>
                        </MudText>
                        <MudGrid>
                            <MudItem xs="6">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">Date:</MudText>
                                <MudText Typo="Typo.body1">@HarvestToDelete.HarvestDate.ToString("dd/MM/yyyy")</MudText>
                            </MudItem>
                            <MudItem xs="6">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">Pigs Sold:</MudText>
                                <MudText Typo="Typo.body1">
                                    <strong>@HarvestToDelete.PigCount pigs</strong>
                                </MudText>
                            </MudItem>
                            <MudItem xs="6">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">Average Weight:</MudText>
                                <MudText Typo="Typo.body1">@HarvestToDelete.AvgWeight.ToString("N1") kg</MudText>
                            </MudItem>
                            <MudItem xs="6">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">Total Weight:</MudText>
                                <MudText Typo="Typo.body1">@HarvestToDelete.TotalWeight.ToString("N1") kg</MudText>
                            </MudItem>
                            <MudItem xs="6">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">Price per Kg:</MudText>
                                <MudText Typo="Typo.body1">฿@HarvestToDelete.SalePricePerKg.ToString("N2")</MudText>
                            </MudItem>
                            <MudItem xs="6">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">Total Revenue:</MudText>
                                <MudText Typo="Typo.body1" Color="Color.Success">
                                    <strong>฿@HarvestToDelete.Revenue.ToString("N2")</strong>
                                </MudText>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudItem>
                
                <MudItem xs="12">
                    <MudAlert Severity="Severity.Error" Dense="true">
                        <MudText Typo="Typo.body2">
                            <strong>⚠️ Warning:</strong> Deleting this harvest will affect your pig pen's revenue calculations and may impact financial reports.
                        </MudText>
                    </MudAlert>
                </MudItem>
            </MudGrid>
        </MudContainer>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel" 
                   Variant="Variant.Text">
            Cancel
        </MudButton>
        <MudButton Color="Color.Error" 
                   Variant="Variant.Filled" 
                   OnClick="Confirm"
                   StartIcon="Icons.Material.Filled.Delete">
            Delete Harvest
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] MudDialogInstance? MudDialog { get; set; }
    [Parameter] public HarvestResult HarvestToDelete { get; set; } = new HarvestResult(Guid.Empty, Guid.Empty, DateTime.Today, 0, 0, 0, 0, 0);

    void Cancel() => MudDialog?.Cancel();

    void Confirm() => MudDialog?.Close(DialogResult.Ok(true));
}