@using Microsoft.AspNetCore.Components
@using MudBlazor
@using PigFarmManagement.Shared.Models

<MudCard Class="mud-height-full">
    <MudCardHeader>
        <CardHeaderContent>
            <div class="d-flex align-center">
                <MudIcon Icon="@GetCustomerIcon(Customer.Type)" Class="mr-2" />
                <MudText Typo="Typo.h6">@Customer.Name</MudText>
            </div>
        </CardHeaderContent>
        <CardHeaderActions>
            <MudMenu Icon="Icons.Material.Filled.MoreVert" AnchorOrigin="Origin.BottomRight">
                <MudMenuItem OnClick="() => OnEdit.InvokeAsync(Customer)">
                    <div class="d-flex align-center">
                        <MudIcon Icon="Icons.Material.Filled.Edit" Class="mr-2" />
                        Edit
                    </div>
                </MudMenuItem>
                <MudMenuItem OnClick="() => OnDelete.InvokeAsync(Customer)">
                    <div class="d-flex align-center">
                        <MudIcon Icon="Icons.Material.Filled.Delete" Class="mr-2" />
                        Delete
                    </div>
                </MudMenuItem>
            </MudMenu>
        </CardHeaderActions>
    </MudCardHeader>
    <MudCardContent>
        <MudText Typo="Typo.body2" Class="mb-2">
            <strong>Code:</strong> @Customer.Code
        </MudText>
        <MudText Typo="Typo.body2" Class="mb-2">
            <strong>Type:</strong> 
            <MudChip Text="@Customer.Type.ToString()" 
                    Color="@GetCustomerTypeColor(Customer.Type)" 
                    Size="Size.Small" />
        </MudText>
        <MudText Typo="Typo.body2" Class="mb-2">
            <strong>Pig Pens:</strong> @PigPenCount
        </MudText>
    </MudCardContent>
    <MudCardActions>
        <MudButton Variant="Variant.Text" 
                  Color="Color.Primary"
                  StartIcon="Icons.Material.Filled.Visibility"
                  OnClick="() => OnViewDetails.InvokeAsync(Customer)">
            View Details
        </MudButton>
    </MudCardActions>
</MudCard>

@code {
    [Parameter] public Customer Customer { get; set; } = null!;
    [Parameter] public int PigPenCount { get; set; }
    [Parameter] public EventCallback<Customer> OnEdit { get; set; }
    [Parameter] public EventCallback<Customer> OnDelete { get; set; }
    [Parameter] public EventCallback<Customer> OnViewDetails { get; set; }

    private string GetCustomerIcon(CustomerType type)
    {
        return type switch
        {
            CustomerType.Cash => Icons.Material.Filled.AccountBalanceWallet,
            CustomerType.Project => Icons.Material.Filled.Work,
            _ => Icons.Material.Filled.Person
        };
    }

    private Color GetCustomerTypeColor(CustomerType type)
    {
        return type switch
        {
            CustomerType.Cash => Color.Success,
            CustomerType.Project => Color.Info,
            _ => Color.Default
        };
    }
}
